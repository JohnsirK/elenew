webpackJsonp([9],{"93fd":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var n=e("mvHQ"),a=e.n(n),r=e("Xxa5"),i=e.n(r),o=e("exGp"),c=e.n(o),d=e("Dd8w"),l=e.n(d),v=e("WsNp"),u=e("NYxO"),_=e("P9l9"),h={data:function(){return{addressData:[],cur:null,pkicon:null}},computed:l()({},Object(u.d)(["userinfo"])),methods:{getAddress:function(){var t=this;return c()(i.a.mark(function s(){var e;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(_.b)(t.userinfo.id);case 2:e=s.sent,t.addressData=e;case 4:case"end":return s.stop()}},s,t)}))()},pick:function(t,s){this.cur=s,this.pkicon=s,this.$emit("selectAddress",t)}},mounted:function(){this.getAddress()}},f={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"addList"},[this.addressData?e("ul",t._l(t.addressData,function(s,n){return e("li",{class:{cur:t.cur==n},on:{click:function(e){return t.pick(s,n)}}},[e("h3",[e("font",[t._v(t._s(s.name))]),t._v(" "),e("em",[t._v("\n\t\t\t\t\t"+t._s(s.phone)+"\n\t\t\t\t")])],1),t._v(" "),e("p",[t._v("\n\t\t\t\t"+t._s(s.address+s.address_detail)+"\n\t\t\t")]),t._v(" "),e("van-icon",{staticClass:"picon",class:{bk:t.pkicon==n},attrs:{name:"certificate"}})],1)}),0):e("p",{staticClass:"noData"},[t._v("\n\t\t暂无地址，请单击下方添加地址信息!\n\t")])])},staticRenderFns:[]};var p=e("VU/8")(h,f,!1,function(t){e("WIwV")},"data-v-2ec49beb",null).exports,m={data:function(){return{imgUrl:"https://elm.cangdu.org/img/",payPick:[{name:"微信支付"},{name:"支付宝"},{name:"现金支付"}],isShow:!1,payEnd:"微信支付",bzShow:!1,bzEnd:[],afterMarks:[],markMessage:"",addressShow:!1,addressSelcet:{},changeTitle:"确认订单",entities:[]}},computed:l()({},Object(u.d)(["nowShop","myFoodCar","userinfo","cartSuccess"]),{allMoney:function(){for(var t=0,s=0;s<this.myFoodCar.length;s++)t+=this.myFoodCar[s].price*this.myFoodCar[s].quantity;return t},markToString:function(){return this.bzEnd.join(",")}}),components:{allHeader:v.a,addressList:p},methods:{pickPayFs:function(){this.isShow=!0},selectPay:function(t){this.payEnd=t.name,this.isShow=!1},getremarks:function(){var t=this;return c()(i.a.mark(function s(){var e;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(_.s)(1);case 2:(e=s.sent)&&(t.afterMarks=t.flatten(e.remarks));case 4:case"end":return s.stop()}},s,t)}))()},pickBz:function(){this.bzShow=!0},flatten:function(t){for(var s=[],e=0,n=t.length;e<n;e++)Array.isArray(t[e])?s=s.concat(this.flatten(t[e])):s.push(t[e]);return s},getDataAddress:function(t){this.addressSelcet=t,this.addressShow=!1},confirmOrder:function(){var t=this;return c()(i.a.mark(function s(){var e;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if("{}"!=a()(t.addressSelcet)){s.next=3;break}return t.$toast("请选择收货地址"),s.abrupt("return");case 3:return t.$toast.loading({mask:!0,message:"下单中,请稍后"}),s.next=6,Object(_.p)(t.userinfo.id,t.cartSuccess.cart.id,t.addressSelcet.id,t.nowShop.id,t.addressSelcet.st_geohash,[t.myFoodCar]);case 6:1==(e=s.sent).status?(t.$toast.clear(),t.$toast(e.success),t.$router.push("/order")):(t.$toast.clear(),t.$toast(e.message));case 8:case"end":return s.stop()}},s,t)}))()}},created:function(){this.getremarks()},watch:{$route:function(t,s){"/confirmOrder/addAddress"==t.path?(this.changeTitle="新增地址",this.addressShow=!1):this.changeTitle="确认订单"}},filters:{tagTxt:function(t){switch(t){case 2:return"家";case 3:return"学校";case 4:return"公司"}}}},k={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"main"},[e("all-header",[e("font",{attrs:{slot:"tl"},slot:"tl"},[t._v("\n\t\t\t"+t._s(t.changeTitle)+"\n\t\t")])],1),t._v(" "),e("div",{staticClass:"content p-b50"},[e("transition",{attrs:{name:"van-slide-left",mode:"out-in"}},[e("router-view")],1),t._v(" "),e("div",{staticClass:"address",on:{click:function(s){t.addressShow=!0}}},["{}"==JSON.stringify(t.addressSelcet)?e("div",{staticClass:"noAddress"},[e("van-icon",{attrs:{name:"location-o"}}),t._v(" "),e("font",[t._v("请选择一个收货地址")]),t._v(" "),e("van-icon",{staticClass:"fl",attrs:{name:"arrow"}})],1):e("div",{staticClass:"haveAddress"},[e("van-icon",{staticClass:"iconinfo",attrs:{name:"location-o"}}),t._v(" "),t.addressSelcet?e("div",{staticClass:"textinfo"},[e("h3",[e("font",[t._v(t._s(t.addressSelcet.name)+" - "+t._s(t.addressSelcet.sex="先生"))]),t._v(" "),e("em",[t._v(t._s(t.addressSelcet.phone))]),t._v(" "),e("b",[t._v(t._s(t._f("tagTxt")(t.addressSelcet.tag_type)))])],1),t._v(" "),e("p",[t._v("\n\t\t\t\t\t\t"+t._s(t.addressSelcet.address)+"\n\t\t\t\t\t\t"+t._s(t.addressSelcet.address_detail)+"\n\t\t\t\t\t")])]):t._e()],1)]),t._v(" "),e("div",{staticClass:"orderList wbg mt20"},[e("dl",[e("dt",[e("span",[e("img",{attrs:{src:t.imgUrl+t.nowShop.image_path,alt:""}})]),t._v("\n\t\t\t\t\t"+t._s(t.nowShop.name)+"\n\t\t\t\t")]),t._v(" "),t._l(t.myFoodCar,function(s,n){return e("dd",{key:n},[e("font",[t._v(t._s(s.name))]),t._v(" "),e("em",[t._v("\n\t\t\t\t\t\tx "+t._s(s.quantity)+"\n\t\t\t\t\t\t"),e("font",[t._v("\n\t\t\t\t\t\t\t￥"+t._s(s.price||0)+"\n\t\t\t\t\t\t")])],1)],1)})],2),t._v(" "),e("h4",[t._v("\n\t\t\t\t配送费:￥"+t._s(t.nowShop.float_delivery_fee)+"\n\t\t\t")]),t._v(" "),e("h4",[t._v("\n\t\t\t\t订单:￥"+t._s(t.allMoney)+"\n\t\t\t")]),t._v(" "),e("h3",[t._v("\n\t\t\t\t待支付：￥"+t._s(t.allMoney+parseInt(t.nowShop.float_delivery_fee))+"\n\t\t\t")])]),t._v(" "),t._m(0),t._v(" "),e("div",{staticClass:"pickPay wbg mt20",on:{click:t.pickPayFs}},[t._v("\n\t\t\t支付方式\n\t\t\t"),e("span",[t._v("\n\t\t\t\t"+t._s(t.payEnd)+"\n\t\t\t\t"),e("van-icon",{staticClass:"fl",attrs:{name:"arrow"}})],1)]),t._v(" "),e("div",{staticClass:"pickPay wbg mt20",on:{click:t.pickBz}},[t._v("\n\t\t\t订单备注\n\t\t\t"),e("span",[t._v("\n\t\t\t\t"+t._s(t.markMessage?t.markMessage:t.markToString)+"\n\t\t\t\t"),e("van-icon",{staticClass:"fl",attrs:{name:"arrow"}})],1)])],1),t._v(" "),e("transition",{attrs:{name:"van-slide-up"}},[t.isShow?e("ul",{staticClass:"payUl"},t._l(t.payPick,function(s,n){return e("li",{key:n,on:{click:function(e){return t.selectPay(s)}}},[t._v("\n\t   \t\t"+t._s(s.name)+"\n\t   \t")])}),0):t._e()]),t._v(" "),e("van-overlay",{attrs:{show:t.isShow},on:{click:function(s){t.isShow=!1}}}),t._v(" "),e("div",{staticClass:"againOrder"},[e("span",[t._v("\n\t\t\t待支付 ￥"+t._s(t.allMoney+parseInt(t.nowShop.float_delivery_fee))+"\n\t\t")]),t._v(" "),e("button",{on:{click:t.confirmOrder}},[t._v("\n\t\t\t确认下单\n\t\t")])]),t._v(" "),e("transition",{attrs:{name:"van-slide-up"}},[t.bzShow?e("div",{staticClass:"beizhu"},[e("h4",[t._v("\n\t\t\t\t快速备注\n\t\t\t")]),t._v(" "),e("van-checkbox-group",{model:{value:t.bzEnd,callback:function(s){t.bzEnd=s},expression:"bzEnd"}},t._l(t.afterMarks,function(s,n){return e("van-checkbox",{key:n,attrs:{name:s}},[t._v("\n\t\t\t\t\t"+t._s(s)+"\n\t\t\t\t")])}),1),t._v(" "),e("h4",[t._v("\n\t\t\t\t其他备注\n\t\t\t")]),t._v(" "),e("van-cell-group",[e("van-field",{attrs:{label:"其他备注",type:"textarea",placeholder:"如您有其他备注,请留言",rows:"1",autosize:""},model:{value:t.markMessage,callback:function(s){t.markMessage=s},expression:"markMessage"}})],1),t._v(" "),e("van-button",{staticClass:"w100",attrs:{type:"info"},on:{click:function(s){t.bzShow=!1}}},[t._v("确认")])],1):t._e()]),t._v(" "),e("van-overlay",{attrs:{show:t.bzShow},on:{click:function(s){t.bzShow=!1}}}),t._v(" "),e("transition",{attrs:{name:"van-slide-up"}},[t.addressShow?e("div",{staticClass:"addressList"},[e("h4",[t._v("\n\t\t\t\t选择地址\n\t\t\t")]),t._v(" "),e("keep-alive",[e("address-list",{on:{selectAddress:t.getDataAddress}})],1),t._v(" "),e("router-link",{staticClass:"add",attrs:{to:"/confirmOrder/addAddress"}},[t._v("\n\t\t\t\t新增地址\n\t\t\t")])],1):t._e()]),t._v(" "),e("van-overlay",{attrs:{show:t.addressShow},on:{click:function(s){t.addressShow=!1}}})],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"sdTime wbg mt20"},[s("h5",[this._v("\n\t\t\t\t送达时间\n\t\t\t")]),this._v(" "),s("p",[this._v("\n\t\t\t\t尽快送达 | 预计20分钟后送达\n\t\t\t\t"),s("span",[this._v("蜂鸟专送")])])])}]};var w=e("VU/8")(m,k,!1,function(t){e("EO8X")},null,null);s.default=w.exports},EO8X:function(t,s){},WIwV:function(t,s){}});